(this.webpackJsonppuhelinluettelo=this.webpackJsonppuhelinluettelo||[]).push([[0],{38:function(e,n,t){},39:function(e,n,t){"use strict";t.r(n);var o=t(2),a=t.n(o),c=t(14),r=t.n(c),s=t(3),i=t(4),u=t.n(i),l="/api/fonebook",d=function(){return u.a.get(l).then((function(e){return e.data}))},m=function(e){return u.a.post(l,e).then((function(e){return e.data}))},b=function(e,n){return u.a.put("".concat(l,"/").concat(e),n).then((function(e){return e.data}))},f=function(e){return u.a.delete("".concat(l,"/").concat(e))},h=t(0),j=function(e){var n=e.handleFilterChange;return Object(h.jsx)("div",{className:"mt-5 mb-5",children:Object(h.jsx)("input",{type:"text",className:"filter-input",placeholder:"find a person..",onChange:n})})},p=function(e){var n=e.handleNameChange,t=e.handleNumberChange,o=e.addPerson;return Object(h.jsxs)("div",{className:"mt-5 mb-5",children:[Object(h.jsx)("h3",{children:"Add new"}),Object(h.jsx)("form",{children:Object(h.jsxs)("div",{className:"row",children:[Object(h.jsx)("span",{className:"flex-1 input-group",children:Object(h.jsx)("input",{id:"nameInputField",className:"person-form-input",type:"text",placeholder:"name..",onChange:n})}),Object(h.jsx)("span",{className:"flex-1 input-group",children:Object(h.jsx)("input",{id:"numberInputField",className:"person-form-input",type:"text",placeholder:"number..",onChange:t})}),Object(h.jsx)("button",{className:"flex-1 add-btn",type:"submit",onClick:o,children:"add"})]})})]})},O=function(e){var n=e.person,t=e.onClick;return Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{className:"flex-2",children:n.name}),Object(h.jsx)("td",{className:"flex-1",children:n.number}),Object(h.jsx)("td",{className:"flex-2 fpull-right",children:Object(h.jsx)("button",{className:"delete-btn",onClick:function(){return t(n.id)},children:"X"})})]})},g=function(e){var n=e.phonebook,t=e.filter,o=e.onClick;return Object(h.jsx)("div",{className:"mt-5 mb-5",children:Object(h.jsx)("table",{children:Object(h.jsx)("tbody",{children:n.filter((function(e){return e.name.toLowerCase().includes(t.toLowerCase())})).map((function(e){return Object(h.jsx)(O,{person:e,onClick:o},e.id)}))})})})},x=function(e){var n=e.message;return null===n.content?Object(h.jsx)(h.Fragment,{}):Object(h.jsx)("div",{className:"mt-5 mb-5",children:Object(h.jsx)("p",{className:n.type,children:n.content})})},N=function(){var e=Object(o.useState)([]),n=Object(s.a)(e,2),t=n[0],a=n[1],c=Object(o.useState)(""),r=Object(s.a)(c,2),i=r[0],u=r[1],l=Object(o.useState)(""),O=Object(s.a)(l,2),N=O[0],v=O[1],k=Object(o.useState)(""),y=Object(s.a)(k,2),C=y[0],F=y[1],w=Object(o.useState)({content:null,type:null}),I=Object(s.a)(w,2),S=I[0],E=I[1];Object(o.useEffect)((function(){d().then((function(e){a(e),console.log("Fonebook database loaded.")})).catch((function(e){console.log(e)}))}),[]);var A=function(){document.getElementById("nameInputField").value="",document.getElementById("numberInputField").value="",u(""),v("")},D=function(e){return-1!==e.response.data.error.search("name")&&-1!==e.response.data.error.search("number")&&-1===e.response.data.error.search("unique")?"Name (min. length 3) and number (min. length 8) are too short.":-1!==e.response.data.error.search("name")&&-1!==e.response.data.error.search("unique")?"Name must be unique (".concat(JSON.parse(e.response.config.data).name," already in database)."):-1!==e.response.data.error.search("name")?"Name is too short (min. length 3).":-1!==e.response.data.error.search("number")?"Number is too short (min. length 8).":void 0},R=function(e,n){E({content:e,type:n}),setTimeout((function(){E({content:null,type:null})}),3e3)};return Object(h.jsxs)("div",{className:"container",children:[Object(h.jsx)("h2",{children:"Fonebook"}),Object(h.jsx)(x,{message:S}),Object(h.jsx)(p,{handleNameChange:function(e){return u(e.target.value)},handleNumberChange:function(e){return v(e.target.value)},addPerson:function(e){var n;e.preventDefault();var o={name:i,number:N};if(t.find((function(e){return e.name===o.name}))&&(n=window.confirm("".concat(o.name," already exists in Fonebook, update the old number with new one?"))),n){var c=t.find((function(e){return e.name===o.name})).id;b(c,o).then((function(e){a(t.map((function(n){return n.id!==c?n:e}))),R("".concat(e.name," number updated."),"msg-info"),console.log("".concat(e.name," number updated.")),A()})).catch((function(e){"DATABASE_ERROR"===e.response.data.type?(R(e.response.data.error,"msg-alert"),a(t.filter((function(e){return e.id!==c})))):"VALIDATION_ERROR"===e.response.data.type?R(D(e),"msg-alert"):console.log(e.response)}))}else m(o).then((function(e){a(t.concat(e)),console.log("".concat(e.name," added to Fonebook")),R("".concat(e.name," added to Fonebook."),"msg-info"),A()})).catch((function(e){R(D(e),"msg-alert")}))}}),Object(h.jsx)("hr",{className:"mt-10 mb-10"}),Object(h.jsx)(j,{handleFilterChange:function(e){return F(e.target.value)}}),Object(h.jsx)(g,{phonebook:t,filter:C,onClick:function(e){var n=t.find((function(n){return n.id===e})).name;window.confirm("Delete ".concat(n," from Fonebook?"))?f(e).then((function(){a(t.filter((function(e){return e.name!==n}))),R("".concat(n," was removed from Fonebook."),"msg-info"),console.log("".concat(n," was removed from Fonebook."))})).catch((function(o){console.log(o),R("No ".concat(n," found on Fonebook."),"msg-alert"),a(t.filter((function(n){return n.id!==e})))})):(R("Deletion cancelled by user.","msg-info"),console.log("Deletion cancelled by user."))}})]})};t(38);r.a.render(Object(h.jsx)(a.a.StrictMode,{children:Object(h.jsx)(N,{})}),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.0f05b0d5.chunk.js.map